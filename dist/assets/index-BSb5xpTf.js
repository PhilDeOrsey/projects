(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function at(r=10){return Math.random().toString(36).substr(2,r)}function j(r,t){return new Array(t).fill(r)}function ht(r,t,e){const n=[];for(let i=0;i<t;++i)n.push(j(r,e));return n}function ct(r,t,e){const n=[];for(let i=0;i<t;++i){const s=[];for(let o=0;o<e;++o)s.push(r(i,o));n.push(s)}return n}function ut(r,t,e=1){const n=[];if(r>=0)for(let i=0;i<r;i+=e)n.push(i);else for(let i=0;i>r;i-=e)n.push(i);return n}function b(r){return r.reduce((t,e)=>t+e,0)}var lt=Object.defineProperty,P=(r,t)=>{for(var e in t)lt(r,e,{get:t[e],enumerable:!0})},X=1e-6;function f(r,t,e=X){return isNaN(r)||isNaN(t)?!1:Math.abs(r-t)<e}function q(r,t,e,n=X){return t>e&&([t,e]=[e,t]),r>t+n&&r<e-n}function A(r,t=1){return Math.round(r/t)*t}function x(r,t=-1/0,e=1/0){return Math.min(e,Math.max(t,r))}function L(r,t,e=.5){return r+(t-r)*e}function I(r){return r*r}function pt(r,t){return(r%t+t)%t}var ft={};P(ft,{determinant:()=>xt,fill:()=>C,identity:()=>T,inverse:()=>O,product:()=>M,reflection:()=>yt,rotation:()=>gt,scalarProduct:()=>mt,shear:()=>dt,sum:()=>N,transpose:()=>F});function C(r,t,e){return ht(r,t,e)}function T(r=2){const t=C(0,r,r);for(let e=0;e<r;++e)t[e][e]=1;return t}function gt(r){const t=Math.sin(r),e=Math.cos(r);return[[e,-t],[t,e]]}function dt(r){return[[1,r],[0,1]]}function yt(r){const t=Math.sin(2*r),e=Math.cos(2*r);return[[e,t],[t,-e]]}function N(...r){const[t,...e]=r,n=e.length>1?N(...e):e[0];if(t.length!==n.length||t[0].length!==n[0].length)throw new Error("Matrix sizes don’t match");const i=[];for(let s=0;s<t.length;++s){const o=[];for(let a=0;a<t[s].length;++a)o.push(t[s][a]+n[s][a]);i.push(o)}return i}function mt(r,t){return r.map(e=>e.map(n=>n*t))}function M(...r){const[t,...e]=r,n=e.length>1?M(...e):e[0];if(t[0].length!==n.length)throw new Error("Matrix sizes don’t match.");const i=[];for(let s=0;s<t.length;++s){const o=[];for(let a=0;a<n[0].length;++a){let h=0;for(let c=0;c<n.length;++c)h+=t[s][c]*n[c][a];o.push(h)}i.push(o)}return i}function F(r){const t=[];for(let e=0;e<r[0].length;++e){const n=[];for(let i=0;i<r.length;++i)n.push(r[i][e]);t.push(n)}return t}function xt(r){if(r.length!==r[0].length)throw new Error("Not a square matrix.");const t=r.length;if(t===1)return r[0][0];if(t===2)return r[0][0]*r[1][1]-r[0][1]*r[1][0];let e=0;for(let n=0;n<t;++n){let i=r[0][n],s=r[0][n];for(let o=1;o<t;++o)s*=r[o][(n+o)%t],i*=r[o][(n-o+t)%t];e+=s-i}return e}function O(r){const t=r.length;if(t!==r[0].length)throw new Error("Not a square matrix.");const e=T(t),n=ct((i,s)=>r[i][s],t,t);for(let i=0;i<t;++i){let s=n[i][i];if(f(s,0)){for(let o=i+1;o<t;++o)if(n[o][i]!==0){for(let a=0;a<t;++a)[n[o][a],n[i][a]]=[n[i][a],n[o][a]],[e[o][a],e[i][a]]=[e[i][a],e[o][a]];break}if(s=n[i][i],f(s,0))throw new Error("Matrix not invertible.")}for(let o=0;o<t;++o)n[i][o]=n[i][o]/s,e[i][o]=e[i][o]/s;for(let o=0;o<t;++o){if(o===i)continue;const a=n[o][i];for(let h=0;h<t;++h)n[o][h]-=a*n[i][h],e[o][h]-=a*e[i][h]}}return e}var S={};P(S,{bernoulli:()=>R,binomial:()=>vt,cauchy:()=>$t,chiCDF:()=>Et,exponential:()=>Lt,find:()=>bt,geometric:()=>It,integer:()=>wt,integrate:()=>V,normal:()=>At,normalPDF:()=>Dt,poisson:()=>Pt,shuffle:()=>Mt,smart:()=>St,uniform:()=>qt,weighted:()=>Y});function Mt(r){r=r.slice(0);for(let t=r.length-1;t>0;--t){const e=Math.floor(Math.random()*(t+1));[r[t],r[e]]=[r[e],r[t]]}return r}function wt(r,t){const e=t===void 0?0:r,n=t===void 0?r:t-r+1;return e+Math.floor(n*Math.random())}function Y(r){const t=Math.random()*b(r);let e=0;return r.findIndex(n=>(e+=n)>=t)}function bt(r){return r[Math.floor(r.length*Math.random())]}var y=new Map;function St(r,t){t||(t=at()),y.has(t)||y.set(t,j(1,r));const e=y.get(t),n=Y(e.map(i=>i*i));return e[n]-=1,e[n]<=0&&y.set(t,e.map(i=>i+1)),n}function R(r=.5){return Math.random()<r?1:0}function vt(r=1,t=.5){let e=0;for(let n=0;n<r;++n)e+=R(t);return e}function Pt(r=1){if(r<=0)return 0;const t=Math.exp(-r);let e=1,n=0;for(;e>t;++n)e*=Math.random();return n-1}function qt(r=0,t=1){return r+(t-r)*Math.random()}function At(r=0,t=1){const e=Math.random(),n=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*n)*Math.sqrt(t)+r}function Lt(r=1){return r<=0?0:-Math.log(Math.random())/r}function It(r=.5){if(!(r<=0||r>1))return Math.floor(Math.log(Math.random())/Math.log(1-r))}function $t(){let r,t,e;do t=2*Math.random()-1,e=2*Math.random()-1,r=t*t+e*e;while(r>=1);return t/e}function Dt(r,t=1,e=0){return Math.exp(-((r-t)**2)/(2*e))/Math.sqrt(2*Math.PI*e)}var $=7,D=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function B(r){if(r<.5)return Math.PI/(Math.sin(Math.PI*r)*B(1-r));r-=1;let t=D[0];for(let n=1;n<$+2;n++)t+=D[n]/(r+n);const e=r+$+.5;return Math.sqrt(2*Math.PI)*Math.pow(e,r+.5)*Math.exp(-e)*t}function V(r,t,e,n=1){let i=0;for(let s=t;s<e;s+=n)i+=r(s)*n||0;return i}function Et(r,t){return 1-V(n=>Math.pow(n,(t-2)/2)*Math.exp(-n/2),0,r)/Math.pow(2,t/2)/B(t/2)}var jt={};P(jt,{bestPolynomial:()=>Ot,coefficient:()=>W,exponential:()=>Tt,linear:()=>Ct,logarithmic:()=>Nt,polynomial:()=>G,power:()=>Ft});function Xt(r,t){let e=1,n=r[0];for(let i=1;i<r.length;++i)e*=t,n+=e*r[i];return n}function Ct(r,t=!1){let e=0,n=0,i=0,s=0;const o=r.length;for(let c=0;c<o;c++)e+=r[c][0],n+=r[c][1],i+=r[c][0]*r[c][0],s+=r[c][0]*r[c][1];if(t)return[0,s/i];const a=(o*s-e*n)/(o*i-e*e);return[n/o-a*e/o,a]}function Tt(r){const t=[0,0,0,0,0,0];for(const s of r)t[0]+=s[0],t[1]+=s[1],t[2]+=s[0]*s[0]*s[1],t[3]+=s[1]*Math.log(s[1]),t[4]+=s[0]*s[1]*Math.log(s[1]),t[5]+=s[0]*s[1];const e=t[1]*t[2]-t[5]*t[5],n=Math.exp((t[2]*t[3]-t[5]*t[4])/e),i=(t[1]*t[4]-t[5]*t[3])/e;return[n,i]}function Nt(r){const t=[0,0,0,0],e=r.length;for(const s of r)t[0]+=Math.log(s[0]),t[1]+=s[1]*Math.log(s[0]),t[2]+=s[1],t[3]+=Math.pow(Math.log(s[0]),2);const n=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]);return[(t[2]-n*t[0])/e,n]}function Ft(r){const t=[0,0,0,0],e=r.length;for(const s of r)t[0]+=Math.log(s[0]),t[1]+=Math.log(s[1])*Math.log(s[0]),t[2]+=Math.log(s[1]),t[3]+=Math.pow(Math.log(s[0]),2);const n=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]);return[Math.exp((t[2]-n*t[0])/e),n]}function G(r,t=2){const e=r.map(h=>ut(t+1).map(c=>Math.pow(h[0],c))),n=F(e),i=r.map(h=>[h[1]]),s=M(n,e),o=O(s);return M(o,n,i).map(h=>h[0])}function W(r,t){const n=r.reduce((o,a)=>o+a[1],0)/r.length,i=r.reduce((o,a)=>o+(a[1]-n)**2,0);return 1-r.reduce((o,a)=>o+(a[1]-t(a[0]))**2,0)/i}function Ot(r,t=.85,e=8){if(!(r.length<=1))for(let n=1;n<e;++n){const i=G(r,n),s=a=>Xt(i,a);if(W(r,s)>=t)return{order:n,coefficients:i,fn:s}}}var Yt=2*Math.PI;function H(r,t){const e=Math.atan2(r.y-(t?t.y:0),r.x-(t?t.x:0));return pt(e,Yt)}var l=class u{constructor(t=0,e=0){this.x=t,this.y=e,this.type="point"}get unitVector(){return f(this.length,0)?new u(1,0):this.scale(1/this.length)}get length(){return Math.sqrt(this.x**2+this.y**2)}get inverse(){return new u(-this.x,-this.y)}get flip(){return new u(this.y,this.x)}get perpendicular(){return new u(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(t){return u.distance(this,t.project(this))}clamp(t,e=0){const n=x(this.x,t.xMin+e,t.xMax-e),i=x(this.y,t.yMin+e,t.yMax-e);return new u(n,i)}changeCoordinates(t,e){const n=e.xMin+(this.x-t.xMin)/t.dx*e.dx,i=e.yMin+(this.y-t.yMin)/t.dy*e.dy;return new u(n,i)}add(t){return u.sum(this,t)}subtract(t){return u.difference(this,t)}round(t=1){return new u(A(this.x,t),A(this.y,t))}floor(){return new u(Math.floor(this.x),Math.floor(this.y))}mod(t,e=t){return new u(this.x%t,this.y%e)}angle(t=v){return H(this,t)}snap(t,e=5){return f(this.x,t.x,e)?new u(t.x,this.y):f(this.y,t.y,e)?new u(this.x,t.y):this}static average(...t){const e=b(t.map(i=>i.x))/t.length,n=b(t.map(i=>i.y))/t.length;return new u(e,n)}static dot(t,e){return t.x*e.x+t.y*e.y}static sum(t,e){return new u(t.x+e.x,t.y+e.y)}static difference(t,e){return new u(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.sqrt(I(t.x-e.x)+I(t.y-e.y))}static manhattan(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}static interpolate(t,e,n=.5){return new u(L(t.x,e.x,n),L(t.y,e.y,n))}static interpolateList(t,e=.5){const n=t.length-1,i=Math.floor(x(e,0,1)*n);return u.interpolate(t[i],t[i+1],n*e-i)}static fromPolar(t,e=1){return new u(e*Math.cos(t),e*Math.sin(t))}static random(t){const e=S.uniform(t.xMin,t.xMax),n=S.uniform(t.yMin,t.yMax);return new u(e,n)}static equals(t,e,n){return f(t.x,e.x,n)&&f(t.y,e.y,n)}static colinear(t,e,n,i){const s=t.x-e.x,o=t.y-e.y,a=e.x-n.x,h=e.y-n.y;return f(s*h,a*o,i)}transform(t){const e=t[0][0]*this.x+t[0][1]*this.y+t[0][2],n=t[1][0]*this.x+t[1][1]*this.y+t[1][2];return new u(e,n)}rotate(t,e=v){if(f(t,0))return this;const n=this.x-e.x,i=this.y-e.y,s=Math.cos(t),o=Math.sin(t),a=n*s-i*o+e.x,h=n*o+i*s+e.y;return new u(a,h)}reflect(t){const e=t.p2.x-t.p1.x,n=t.p2.y-t.p1.y,i=this.x-t.p1.x,s=this.y-t.p1.y,o=(e*s-n*i)/(e*e+n*n),a=this.x+2*o*n,h=this.y-2*o*e;return new u(a,h)}scale(t,e=t){return new u(this.x*t,this.y*e)}shift(t,e=t){return new u(this.x+t,this.y+e)}translate(t){return this.shift(t.x,t.y)}equals(t,e){return u.equals(this,t,e)}toString(){return`point(${this.x},${this.y})`}},v=new l(0,0);function Rt(r){return r.type==="ray"}function Bt(r){return r.type==="segment"}var g=class d{constructor(t,e){this.p1=t,this.p2=e,this.type="line"}get length(){return l.distance(this.p1,this.p2)}get lengthSquared(){return(this.p1.x-this.p2.x)**2+(this.p1.y-this.p2.y)**2}get midpoint(){return l.average(this.p1,this.p2)}get slope(){return(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)}get intercept(){return this.p1.y-this.slope*this.p1.x}get angle(){return H(this.p2,this.p1)}get unitVector(){return this.p2.subtract(this.p1).unitVector}get perpendicularVector(){return new l(this.p2.y-this.p1.y,this.p1.x-this.p2.x).unitVector}parallel(t){return new d(t,t.add(this.p2).subtract(this.p1))}perpendicular(t){const e=this.line.project(t);return l.equals(t,e)?new d(e,e.add(this.perpendicularVector.scale(this.length/2))):new d(e,t)}get perpendicularBisector(){return this.perpendicular(this.midpoint)}distanceSquared(t){const e=this.project(t);return(t.x-e.x)**2+(t.y-e.y)**2}get line(){return this.type==="line"?this:new d(this.p1,this.p2)}get ray(){return Rt(this)?this:new Vt(this.p1,this.p2)}get segment(){return Bt(this)?this:new Gt(this.p1,this.p2)}offset(t){const e=l.difference(this.p2,this.p1),n=l.difference(t,this.p1);return l.dot(e,n)/this.lengthSquared}project(t){return this.at(this.offset(t))}side(t,e){const n=l.difference(this.p2,this.p1),i=l.difference(t,this.p1),s=i.x*n.y-i.y*n.x;return f(s,0,e)?0:Math.sign(s)}contains(t,e){return this.side(t,e)===0}at(t){return l.interpolate(this.p1,this.p2,t)}transform(t){return new this.constructor(this.p1.transform(t),this.p2.transform(t))}rotate(t,e=v){return f(t,0)?this:new this.constructor(this.p1.rotate(t,e),this.p2.rotate(t,e))}reflect(t){return new this.constructor(this.p1.reflect(t),this.p2.reflect(t))}scale(t,e=t){return new this.constructor(this.p1.scale(t,e),this.p2.scale(t,e))}shift(t,e=t){return new this.constructor(this.p1.shift(t,e),this.p2.shift(t,e))}translate(t){return this.shift(t.x,t.y)}equals(t,e){return this.contains(t.p1,e)&&this.contains(t.p2,e)}toString(){return`line(${this.p1},${this.p2})`}},Vt=class extends g{constructor(){super(...arguments),this.type="ray"}equals(r,t){return r.type!=="ray"||!this.p1.equals(r.p1,t)?!1:this.p2.equals(r.p2,t)?!0:r.contains(this.p2,t)||this.contains(r.p2,t)}contains(r,t){if(!super.contains(r,t))return!1;const e=this.offset(r);return f(e,0,t)||e>0}toString(){return`ray(${this.p1},${this.p2})`}},Gt=class U extends g{constructor(){super(...arguments),this.type="segment"}contains(t,e){return super.contains(t,e)?this.p1.equals(t,e)||this.p2.equals(t,e)?!0:f(this.p1.x,this.p2.x,e)?q(t.y,this.p1.y,this.p2.y):q(t.x,this.p1.x,this.p2.x):!1}project(t){const e=l.difference(this.p2,this.p1),n=l.difference(t,this.p1),i=x(l.dot(e,n)/this.lengthSquared,0,1);return this.p1.add(e.scale(i))}contract(t){return new U(this.at(t),this.at(1-t))}equals(t,e,n=!1){return t.type!=="segment"?!1:this.p1.equals(t.p1,e)&&this.p2.equals(t.p2,e)||!n&&this.p1.equals(t.p2,e)&&this.p2.equals(t.p1,e)}toString(){return`segment(${this.p1},${this.p2})`}};const m=r=>r.split(" ").map(e=>{const[n,i]=e.split(",").map(Number);return new l(n,i)}),E=r=>r.map(t=>`${t.x},${t.y}`).join(" ");class Wt{constructor(t){this.isDragging=!1,this.currentShape=null,this.currentShapeType=null,this.offsetX=0,this.offsetY=0,this.mirrorLines=[],this.imageMap=new Map,this.config=t,this.setupMirrors(),this.initializeShapes(),this.bindEvents(),console.log(this.imageMap)}createShape(t){const e=document.createElementNS("http://www.w3.org/2000/svg",t.type);return Object.entries(t.attributes).forEach(([n,i])=>{e.setAttribute(n,i.toString())}),e.setAttribute("data-shape-id",t.id),e.setAttribute("data-shape-type",t.type),e.setAttribute("data-draggable",t.draggable?"true":"false"),e.setAttribute("role","graphics-symbol"),e.setAttribute("aria-label",`${t.draggable?"Draggable ":""}${t.type}`),t.draggable&&(e.style.cursor="grab"),e}initializeShapes(){const{svg:t,shapes:e,bounds:n}=this.config;t.innerHTML="",[{id:"room-boundary",type:"path",attributes:{d:`M ${n.x},${n.y} 
           L ${n.x+n.width},${n.y} 
           L ${n.x+n.width},${n.y+n.height} 
           L ${n.x},${n.y+n.height} 
           Z`,fill:"none",stroke:"#cccccc",strokeWidth:"2"},draggable:!1},...e].forEach(o=>{const a=this.createShape(o);this.buildImages({svg:t,shapeEl:a,shapeData:o}),t.appendChild(a)})}bindEvents(){this.config.svg.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this))}buildCircleImage(t,e){const{svg:n,shapeEl:i,shapeData:s}=t,o=this.reflectCircle(i,e),a=this.createShape({id:s.id,type:"circle",attributes:{cx:o.x,cy:o.y,r:s.attributes.r,fill:"gray"},draggable:!1});return n.appendChild(a),this.imageMap.set(s.id,[...this.imageMap.get(s.id)||[],{shape:a,line:e,id:s.id}]),a}buildPolygonImage(t,e){const{svg:n,shapeEl:i,shapeData:s}=t,o=this.reflectPolygon(i,e)||"",a=this.createShape({id:s.id,type:"polygon",attributes:{points:o,fill:"gray"},draggable:!1});return n.appendChild(a),this.imageMap.set(t.parentId,[...this.imageMap.get(t.parentId)||[],{shape:a,line:e,id:s.id}]),a}buildImages(t){const e=this.mirrorLines.length;if(t.shapeData.type==="circle")for(let n=0;n<e;n++){const i=this.buildCircleImage(t,this.mirrorLines[n]);for(let s=0;s<e;s++){if(n===s)continue;const o={...t,shapeEl:i};this.buildCircleImage(o,this.mirrorLines[s])}}else if(t.shapeData.type==="polygon")for(let n=0;n<e;n++){const i={...t,shapeData:{...t.shapeData,id:t.shapeData.id+`reflection${n}`},parentId:t.shapeData.id},s=this.buildPolygonImage(i,this.mirrorLines[n]);for(let o=0;o<e;o++){if(n===o)continue;const a={...t,shapeEl:s,shapeData:{...t.shapeData,id:t.shapeData.id+`reflection${n}${o}`},parentId:t.shapeData.id+`reflection${n}`};this.buildPolygonImage(a,this.mirrorLines[o])}}}setupMirrors(){const{mirrorLocation:t,bounds:e,svg:n}=this.config;if(!t)return;const i=new l(e.x,e.y),s=new l(e.x+e.width,e.y),o=new l(e.x+e.width,e.y+e.height),a=new l(e.x,e.y+e.height);if(["top-bottom","all"].includes(t)){const h=new g(i,s),c=new g(a,o);this.mirrorLines.push(h,c),this.drawMirror(h,"MirrorTop"),this.drawMirror(c,"MirrorBot")}if(["left-right","all"].includes(t)){const h=new g(i,a),c=new g(s,o);this.mirrorLines.push(h,c),this.drawMirror(h,"MirrorLeft"),this.drawMirror(c,"MirrorRight")}}drawMirror(t,e){const[n,i]=[t.p1,t.p2];this.config.svg.append(this.createShape({id:e,type:"path",attributes:{d:`M ${n.x},${n.y} L ${i.x},${i.y}`,fill:"none",stroke:"blue",strokeWidth:"6"},draggable:!1}))}onMouseDown(t){const e=t.target;if(!e||!(e instanceof SVGGraphicsElement)||!(e.getAttribute("data-draggable")==="true"))return;const i=e.getAttribute("data-shape-type");if(!i)return;this.isDragging=!0,this.currentShape=e,this.currentShapeType=i,this.currentShape.style.cursor="grabbing";const s=this.config.svg.getBoundingClientRect();if(i==="circle"){const o=parseFloat(e.getAttribute("cx")||"0"),a=parseFloat(e.getAttribute("cy")||"0");this.offsetX=t.clientX-s.left-o,this.offsetY=t.clientY-s.top-a}else{const o=parseFloat(m(e.getAttribute("points"))[0].x.toString()),a=parseFloat(m(e.getAttribute("points"))[0].y.toString());this.offsetX=t.clientX-s.left-o,this.offsetY=t.clientY-s.top-a}}onMouseMove(t){if(!this.isDragging||!this.currentShape||!this.currentShapeType)return;const e=this.config.svg.getBoundingClientRect(),n=this.config.bounds;let i=t.clientX-e.left-this.offsetX,s=t.clientY-e.top-this.offsetY;if(this.currentShapeType==="circle"){const o=parseFloat(this.currentShape.getAttribute("r")||"0");i=Math.max(n.x+o,Math.min(i,n.x+n.width-o)),s=Math.max(n.y+o,Math.min(s,n.y+n.height-o)),this.currentShape.setAttribute("cx",i.toString()),this.currentShape.setAttribute("cy",s.toString());const a=this.imageMap.get(this.currentShape.getAttribute("data-shape-id"));for(const h of a||[]){const c=this.reflectCircle(this.currentShape,h.line);h.shape.setAttribute("cx",c.x.toString()),h.shape.setAttribute("cy",c.y.toString())}}else if(this.currentShapeType==="polygon"){const o=this.currentShape.getAttribute("points");if(!o)return;const a=m(o),h=Math.min(...a.map(p=>p.x)),c=Math.min(...a.map(p=>p.y)),k=Math.max(...a.map(p=>p.x)),K=Math.max(...a.map(p=>p.y)),Z=k-h,z=K-c,J=Math.max(n.x,Math.min(i,n.x+n.width-Z)),Q=Math.max(n.y,Math.min(s,n.y+n.height-z)),_=J-h,tt=Q-c,et=a.map(p=>new l(p.x+_,p.y+tt)),nt=E(et);this.currentShape.setAttribute("points",nt);const rt=this.imageMap.get(this.currentShape.getAttribute("data-shape-id"));for(const p of rt||[]){console.log(p);const it=this.reflectPolygon(this.currentShape,p.line);p.shape.setAttribute("points",it);const st=this.imageMap.get(p.id);for(const w of st||[]){console.log(w);const ot=this.reflectPolygon(p.shape,w.line);w.shape.setAttribute("points",ot)}}}}getShapeSize(t){const e=t.getBBox();return{width:e.width,height:e.height}}onMouseUp(){this.currentShape&&(this.currentShape.style.cursor="grab"),this.isDragging=!1,this.currentShape=null,this.currentShapeType=null}reflectCircle(t,e){if(t.getAttribute("data-shape-type")!=="circle")return;const n=parseFloat(t.getAttribute("cx")||"0"),i=parseFloat(t.getAttribute("cy")||"0");return new l(n,i).reflect(e)}reflectPolygon(t,e){if(t.getAttribute("data-shape-type")!=="polygon")return;const i=m(t.getAttribute("points")).map(s=>s.reflect(e));return E(i)}updateShapes(t){this.config.shapes=t,this.initializeShapes()}updateBounds(t){this.config.bounds=t}destroy(){window.removeEventListener("mousemove",this.onMouseMove.bind(this)),window.removeEventListener("mouseup",this.onMouseUp.bind(this))}}const Ht=[{id:"circle1",type:"circle",attributes:{cx:500,cy:350,r:15,fill:"blue"},draggable:!0},{id:"poly1",type:"polygon",attributes:{points:"450,400 525,400 525,450 450,450 475,425",fill:"red"},draggable:!0}],Ut={x:400,y:300,width:200,height:200},kt={svg:document.querySelector("svg"),shapes:Ht,bounds:Ut,mirrorLocation:"all"};new Wt(kt);
